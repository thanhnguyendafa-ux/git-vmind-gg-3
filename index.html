
<!DOCTYPE html>
<html lang="en" class="h-full w-full overflow-hidden">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  
  <!-- PWA Configuration -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Vmind" />
  <link rel="apple-touch-icon" href="/vite.svg" />
  <meta name="theme-color" content="#F4F7F5" />

  <!-- Viewport Configuration: viewport-fit=cover is essential for full-screen iOS PWAs -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  
  <title>Vmind - Vocabulary Learning</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Comfortaa:wght@400;700&family=Fredoka:wght@300..700&family=Inter:wght@400;500;600;700&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Merriweather:wght@300;400;700&family=Nunito:wght@400;700&family=Nunito+Sans:wght@400;600;700&family=Quicksand:wght@400;700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Base Variables (Vmind 3.0 - Morning Mist) */
      --color-background: #F8FAF9;
      --color-surface: #FFFFFF;
      --color-text-main: #0D1F1A;
      --color-text-subtle: #60736D;
      --color-border: #D8E0DC;
      
      /* Accents */
      --color-primary-500: #3DDC84; /* Neon Mint */
      --color-primary-600: #059669; /* Emerald Deep */
      --color-secondary-500: #64748b;
      
      --color-primary-50: #f0fdf4;
      --color-secondary-50: #f8fafc;
      
      --shadow-color: rgba(16, 185, 129, 0.1); /* Emerald Shadow */
    }

    /* Deep Forest (Dark Mode) */
    .dark {
      --color-background: #0F1A17; /* Deep Hunter Green */
      --color-surface: #132720;    /* Dark Moss */
      --color-text-main: #E9F5EE;  /* Pale Mint */
      --color-text-subtle: #88A496; /* Sage */
      --color-border: #1F3A32;
      
      --color-primary-500: #3DDC84;
      --color-primary-600: #10B981;
      
      --color-secondary-500: #64748b;
      --color-primary-50: #052e16;
      --color-secondary-50: #0D1F1A;
      
      --shadow-color: rgba(0, 0, 0, 0.5);
    }

    /* Soft Focus (Pastel Theme) */
    [data-theme='pastel'] {
      --color-background: #FDFCF0;
      --color-surface: #FFFFFF;
      --color-primary-500: #A0E8AF; /* Matcha Latte */
      --color-primary-600: #74C686;
      --color-secondary-500: #DCD6F7; /* Lavender Mist */
      --color-text-main: #4A4E69; /* Deep Charcoal */
      --color-text-subtle: #84889A; /* Slate */
      --color-border: transparent;
      --shadow-color: rgba(160, 232, 175, 0.25);
      
      --color-primary-50: #F0FFF4; 
      --color-secondary-50: #FDFDFF;
    }

    /* Apply variables to body */
    body {
      background-color: var(--color-background);
      color: var(--color-text-main);
    }

    /* Disable background image in Dark Mode */
    .dark body {
      background-image: none;
    }

    /* Noise Texture Class */
    .bg-noise {
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
    }

    /* Dream Overlay for Garden Preview */
    .dream-overlay {
      position: relative;
    }
    .dream-overlay::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at center, transparent 0%, rgba(255, 223, 0, 0.1) 70%, rgba(255, 215, 0, 0.2) 100%);
      pointer-events: none;
      z-index: 50;
      mix-blend-mode: screen;
      box-shadow: inset 0 0 40px rgba(255, 215, 0, 0.3);
      border-radius: 0.75rem; /* matches rounded-xl */
    }
    .dark .dream-overlay::after {
        background: radial-gradient(circle at center, transparent 0%, rgba(139, 92, 246, 0.1) 60%, rgba(76, 29, 149, 0.3) 100%);
        box-shadow: inset 0 0 40px rgba(139, 92, 246, 0.2);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fade-scale-in {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes slideInUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    @keyframes pulse-bg {
      0%, 100% { background-color: rgba(22, 163, 74, 0.2); }
      50% { background-color: rgba(22, 163, 74, 0.4); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    @keyframes ai-glow {
        0%, 100% { box-shadow: 0 0 0 0 rgba(61, 220, 132, 0); }
        50% { box-shadow: 0 0 8px 2px rgba(61, 220, 132, 0.4); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideOutLeft {
      from { opacity: 1; transform: translateX(0); }
      to { opacity: 0; transform: translateX(-25%); }
    }
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(25%); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes slideInFromRight {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }

    /* --- New Animations for Reading Space Focus Mode --- */
    @keyframes book-open-enter {
      from { opacity: 0; transform: scaleX(0.1) rotateY(-80deg); }
      to { opacity: 1; transform: scaleX(1) rotateY(0deg); }
    }
    @keyframes book-open-leave {
      from { opacity: 1; transform: scaleX(1) rotateY(0deg); }
      to { opacity: 0; transform: scaleX(0.1) rotateY(80deg); }
    }

    .animate-book-open-enter {
      transform-origin: left;
      animation: book-open-enter 0.5s cubic-bezier(0.25, 1, 0.5, 1) forwards;
    }
    .animate-book-open-leave {
      transform-origin: right;
      animation: book-open-leave 0.4s cubic-bezier(0.5, 0, 0.75, 0) forwards;
    }

    .animate-fadeIn { animation: fadeIn 0.6s ease-out forwards; }
    .animate-fade-scale-in { animation: fade-scale-in 0.3s ease-out; }
    .animate-slideInUp { animation: slideInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
    .animate-pulse-bg { animation: pulse-bg 2s infinite; }
    .animate-shake { animation: shake 0.3s ease-in-out; }
    .animate-ai-glow { animation: ai-glow 2.5s infinite; }
    .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
    .animate-slide-out-left { animation: slideOutLeft 0.1s ease-in forwards; }
    .animate-slide-in-right { animation: slideInRight 0.1s ease-out forwards; }
    .animate-slide-in-from-right { animation: slideInFromRight 0.3s ease-out forwards; }
    .animate-float { animation: float 6s ease-in-out infinite; }

    /* Custom selection color for focus mode in ReadingScreen */
    .reading-content-focus::selection {
      background-color: var(--color-primary-500);
      color: var(--color-background);
    }
    .reading-content-focus::-moz-selection { /* Firefox */
      background-color: var(--color-primary-500);
      color: var(--color-background);
    }

    /* --- New: Living Paper Texture for Focus Mode --- */
    .focus-paper-bg {
      background-image: url('https://storage.googleapis.com/aai-web-samples/vmind/textures/paper.png');
      background-color: #FAF8F5;
      box-shadow: 0 10px 30px -5px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
    }
    .dark .focus-paper-bg {
        background-color: #132720; /* Surface Green */
        box-shadow: 0 10px 30px -5px rgba(0,0,0,0.5), 0 4px 6px -2px rgba(0,0,0,0.3);
    }

    /* --- Pro Grain Texture for 'Sepia' Theme --- */
    .theme-paper-grain {
        /* Subtle noise pattern */
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        background-repeat: repeat;
        background-blend-mode: multiply;
    }

    .perspective-1000 { perspective: 1000px; }
    .transform-style-3d { transform-style: preserve-3d; }

    @keyframes card-flip-out-next {
      from { transform: rotateY(0deg); opacity: 1; }
      to { transform: rotateY(-90deg); opacity: 0; }
    }
    .animate-card-flip-out-next { animation: card-flip-out-next 0.15s ease-in forwards; }

    @keyframes card-flip-in-next {
      from { transform: rotateY(90deg); opacity: 0; }
      to { transform: rotateY(0deg); opacity: 1; }
    }
    .animate-card-flip-in-next { animation: card-flip-in-next 0.15s ease-out forwards; }

    @keyframes card-flip-out-prev {
      from { transform: rotateY(0deg); opacity: 1; }
      to { transform: rotateY(90deg); opacity: 0; }
    }
    .animate-card-flip-out-prev { animation: card-flip-out-prev 0.15s ease-in forwards; }

    @keyframes card-flip-in-prev {
      from { transform: rotateY(-90deg); opacity: 0; }
      to { transform: rotateY(0deg); opacity: 1; }
    }
    .animate-card-flip-in-prev { animation: card-flip-in-prev 0.15s ease-out forwards; }
    
    .card-container.no-transition .card-flip {
      transition: none;
    }
    
    /* Card flip transition */
    .card-container.flipped .card-flip {
      transform: rotateY(180deg);
    }
    .card-flip {
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    .card-front, .card-back {
      -webkit-backface-visibility: hidden; /* Safari */
      backface-visibility: hidden;
    }
    .card-back {
      transform: rotateY(180deg);
    }
    .truncate-2-lines {
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    .truncate-3-lines {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
    }
    .truncate-1-line {
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
    }
    .hide-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
    .hide-scrollbar::-webkit-scrollbar {
        display: none; /* Safari and Chrome */
    }
    .overflow-fade-out::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3rem;
        background: linear-gradient(to top, var(--color-surface), transparent);
        pointer-events: none;
    }
    
    /* Scrollbar styling for app-like feel */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent; 
    }
    ::-webkit-scrollbar-thumb {
      background: #cbd5e1; 
      border-radius: 3px;
    }
    .dark ::-webkit-scrollbar-thumb {
      background: #475569; 
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8; 
    }

    /* Print Logic for Vmind 3.0 */
    @media print {
      /* 1. Hide everything by default */
      body * {
        visibility: hidden;
      }
      
      /* 2. Show only the print target and its children */
      body.is-printing .vmind-print-target,
      body.is-printing .vmind-print-target * {
        visibility: visible;
      }
      
      /* 3. Reset Body */
      body.is-printing {
        background-color: white !important;
        color: black !important;
        overflow: visible !important;
      }
      
      /* 4. Center the card on the printed page */
      body.is-printing .vmind-print-target {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        max-width: 600px;
        border: 1px solid #ccc;
        box-shadow: none !important;
        background-color: white !important;
        color: black !important;
        z-index: 9999;
        margin: 0;
        padding: 20px;
        page-break-inside: avoid;
      }
      
      /* 
         5. Force SVG/Stroke colors to black for UI Icons ONLY.
         We target SVGs with Tailwind width classes (w-4, w-5, w-6, etc.) which are typical for UI icons.
         This prevents corrupting HanziWriter SVGs which don't use these classes.
      */
      body.is-printing .vmind-print-target svg[class*="w-"],
      body.is-printing .vmind-print-target svg[class*="w-"] path,
      body.is-printing .vmind-print-target svg[class*="w-"] line,
      body.is-printing .vmind-print-target svg[class*="w-"] circle,
      body.is-printing .vmind-print-target svg[class*="w-"] rect {
        stroke: black !important;
        fill: black !important;
        opacity: 1 !important;
        visibility: visible !important;
      }

      /* 
         7. HanziWriter Specific Print Styles 
         Forces strokes to be visible black ink regardless of theme state.
      */
      body.is-printing .hanzi-writer-wrapper svg,
      body.is-printing .hanzi-writer-wrapper svg path {
          fill: black !important;
          stroke: black !important;
          opacity: 1 !important;
          visibility: visible !important;
      }
      
      /* 6. Hide interactive elements within the card */
      body.is-printing .vmind-print-target button,
      body.is-printing .vmind-print-target .no-print {
          display: none !important;
      }
    }
  </style>
<script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: { 
                50: 'var(--color-primary-50)', 
                100: '#dcfce7', 
                200: '#bbf7d0', 
                300: '#86efac', 
                400: '#4ade80', 
                500: 'var(--color-primary-500)', 
                600: 'var(--color-primary-600)', 
                700: '#15803d', 
                800: '#166534', 
                900: '#14532d', 
                950: '#052e16' 
            },
            secondary: { 
                50: 'var(--color-secondary-50)', 
                100: '#F4F7F5', 
                200: '#EDF2EE', 
                300: '#D8E0DC', 
                400: '#88A496', 
                500: 'var(--color-secondary-500)', 
                600: '#60736D', 
                700: '#1F3A32', 
                800: '#132720', 
                900: '#0D1F1A', 
                950: '#020617' 
            },
            success: { 50: '#f0fdfa', 100: '#ccfbf1', 200: '#99f6e4', 300: '#5eead4', 400: '#2dd4bf', 500: '#14b8a6', 600: '#0d9488', 700: '#0f766e', 800: '#115e59', 900: '#134e4a', 950: '#042f2e' },
            error: { 50: '#fff1f2', 100: '#ffe4e6', 200: '#fecdd3', 300: '#fda4af', 400: '#fb7185', 500: '#f43f5e', 600: '#e11d48', 700: '#be123c', 800: '#9f1239', 900: '#881337', 950: '#4c0519' },
            warning: { 50: '#fffbeb', 100: '#fef3c7', 200: '#fde68a', 300: '#fcd34d', 400: '#fbbf24', 500: '#f59e0b', 600: '#d97706', 700: '#b45309', 800: '#92400e', 900: '#78350f', 950: '#451a03' },
            info: { 50: '#ecfeff', 100: '#cffafe', 200: '#a5f3fc', 300: '#67e8f9', 400: '#22d3ee', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63', 950: '#083344' },
            'background': 'var(--color-background)',
            'surface': 'var(--color-surface)',
            'text-main': 'var(--color-text-main)',
            'text-subtle': 'var(--color-text-subtle)',
            'border': 'var(--color-border)',
          },
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            serif: ['Lora', 'serif'],
            merriweather: ['Merriweather', 'serif'],
            nunitosans: ['Nunito Sans', 'sans-serif'],
            literata: ['Literata', 'serif'],
            quicksand: ['Quicksand', 'sans-serif'],
            fredoka: ['Fredoka', 'sans-serif'],
            space: ['Space Grotesk', 'sans-serif'],
            comfortaa: ['Comfortaa', 'cursive'],
            nunito: ['Nunito', 'sans-serif'],
            bevietnam: ['"Be Vietnam Pro"', 'sans-serif'],
            jakarta: ['"Plus Jakarta Sans"', 'sans-serif'],
          },
        },
      },
    }
  </script>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.28.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "@supabase/supabase-js": "https://aistudiocdn.com/@supabase/supabase-js@^2.45.0",
    "zustand": "https://aistudiocdn.com/zustand@^4.5.4/index.js",
    "zustand/": "https://aistudiocdn.com/zustand@^4.5.4/",
    "zustand/middleware": "https://aistudiocdn.com/zustand@^4.5.4/middleware.js",
    "@tanstack/react-query": "https://aistudiocdn.com/@tanstack/react-query@^5.51.1",
    "@tanstack/react-virtual": "https://aistudiocdn.com/@tanstack/react-virtual@^3.2.0",
    "@testing-library/react": "https://aistudiocdn.com/@testing-library/react@^16.3.0",
    "vitest": "https://aistudiocdn.com/vitest@^4.0.8",
    "@testing-library/user-event": "https://aistudiocdn.com/@testing-library/user-event@^14.6.1",
    "d3": "https://aistudiocdn.com/d3@^7.9.0",
    "hanzi-writer": "https://esm.sh/hanzi-writer@3.5.0",
    "react-dom": "https://aistudiocdn.com/react-dom@^19.2.0",
    "xlsx": "https://cdn.sheetjs.com/xlsx-0.20.0/package/xlsx.mjs"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="antialiased font-sans h-full w-full overflow-hidden">
  <div id="root" class="h-full w-full"></div>
  <script type="module" src="/index.tsx"></script>
</body>
</html>